
BEGIN
  FOR l_counter IN 1..5
  LOOP
  
  
	DECLARE BatchID NUMBER;
		PurchaseAmountLocal NUMBER;
		TransactionID_NEW NUMBER;
		ClassificationID_New NUMBER;
		DBTimeZone_New VARCHAR(10);
		SellerFName VARCHAR2(100);
		SellerLName VARCHAR2(100);
		RandomWaitTimeMS NUMBER;
	begin
	
		BatchID:=floor(dbms_random.value(1, 9999999999999999999999999));
	
		PurchaseAmountLocal:=round(dbms_random.value(1, 10000000) / floor(dbms_random.value(1, 1000)), 10);
	
		ClassificationID_New:=floor(dbms_random.value(1, 19947));
		
		SELECT (MAX(TRANSACTIONID)+1) INTO TransactionID_NEW FROM QATEST.Transactions t;
		
		SELECT DBTIMEZONE INTO DBTimeZone_New FROM dual;
		
		SELECT FirstName INTO SellerFName FROM QATEST.FIRSTNAMES WHERE ID = (select COALESCE(MAX(ID), 4357) from QATEST.FIRSTNAMES sample (.015));
		
		SELECT LastName INTO SellerLName FROM QATEST.LASTNAMES WHERE ID = (select COALESCE(MAX(ID), 74145) from QATEST.LASTNAMES sample (.015));
		
		
		INSERT INTO QATEST.TRANSACTIONS
			(TRANSACTIONID, BATCHID, TRANSACTIONDATE, TRANSACTIONFULLDATE, DATATYPE, PURCHASEAMTUSD, PURCHASEAMOUNTLOCAL, CLASSIFICATIONID, SELLERNAME, TRANSACTIONFROMSTRIIMDATETIME, DBTIMEZONE)
		VALUES 
			(TransactionID_NEW, BatchID, SYSDATE, SYSDATE, 'P', ROUND(PurchaseAmountLocal/342.2, 2), PurchaseAmountLocal, ClassificationID_New, SellerFName || ' ' || SellerLName, SYSDATE, DBTimeZone_New);
						
		RandomWaitTimeMS := dbms_random.value(0, 3);
		--dbms_lock.sleep(1);
		sys.dbms_session.sleep(RandomWaitTimeMS);
	end;


  END LOOP;
END;

SELECT t.*
FROM QATEST.TRANSACTIONS t
ORDER BY t.TRANSACTIONID DESC;


/*
CREATE TABLE QATEST.TRANSACTIONS (
	TRANSACTIONID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
	BATCHID NUMBER,
	TRANSACTIONDATE DATE,
	TRANSACTIONFULLDATE TIMESTAMP,
	DATATYPE CHAR(1),
	PURCHASEAMTUSD FLOAT(126),
	PURCHASEAMOUNTLOCAL NUMBER(25,7),
	CLASSIFICATIONID NUMBER,
	SELLERNAME VARCHAR2(100),
	TRANSACTIONFROMSTRIIMDATETIME TIMESTAMP,
	DBTIMEZONE VARCHAR2(10)
);
*/

